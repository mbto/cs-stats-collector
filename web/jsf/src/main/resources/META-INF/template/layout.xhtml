<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
<f:metadata>
    <f:loadBundle basename="application" var="springConfig" />
</f:metadata>

<h:head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="robots" content="noindex"/>

    <link rel="shortcut icon" type="image/x-icon" href="#{resource['images/emblem.png']}"/>
<!--    <title><ui:insert name="title">#{springConfig['collector.instance.name']}</ui:insert></title>-->
    <title><ui:insert name="title">
        <h:outputText value="#{'[' += sessionInstanceHolder.currentInstanceId += '] ' += sessionInstanceHolder.availableInstances.get(sessionInstanceHolder.currentInstanceId).name}"
                      rendered="#{not empty sessionInstanceHolder.currentInstanceId}" />
        <h:outputText value="Instance not setted"
                      rendered="#{empty sessionInstanceHolder.currentInstanceId}" />
    </ui:insert></title>

    <h:outputStylesheet name="css/default.css" />
    <ui:insert name="head"/>
</h:head>

<h:body>
    <p:growl id="growl" life="5000" severity="warn" globalOnly="true" />
<!--    <p:tooltip position="bottom" />-->

    <div class="ui-g">
        <div class="ui-g-12">
            <p:outputPanel style="text-align:center;display:block;margin: 0 auto;">
                <h:form>
                    <p:selectOneMenu value="#{sessionInstanceHolder.currentInstanceId}" style="width: 200px;">
                        <f:selectItem itemLabel="Select instance" noSelectionOption="true" itemDisabled="true"/>
                        <f:selectItems value="#{sessionInstanceHolder.availableInstances.entrySet()}" var="entry"
                                       itemLabel="#{'[' += entry.key += '] ' += entry.value.name += (empty entry.value.description ? '' : (' (' += entry.value.description += ')'))}"
                                       itemValue="#{entry.value.id}"/>

                        <p:ajax event="change" process="@this" update="@none" immediate="true"
                                onsuccess="document.location.href = document.location.href;" />
                    </p:selectOneMenu>
                </h:form>
            </p:outputPanel>
        </div>
        <div class="ui-g-12">
            <div class="ui-g">
                <div class="ui-g-12 ui-xl-12 ui-lg-12 ui-md-12 ui-sm-12 ui-g-nopad">
                    <p:outputPanel style="margin-bottom:10px;">
                        <p:button href="/" value="Dashboard"/>
                        <p:button outcome="/projects" value="Projects"/>
                        <p:button outcome="/managers" value="Managers"/>
                    </p:outputPanel>
                </div>
                <div class="ui-g-12 ui-xl-12 ui-lg-12 ui-md-12 ui-sm-12 ui-g-nopad">
                    <ui:insert name="center"/>
                </div>
            </div>
        </div>
    </div>

    <ui:insert name="excepts">
        <p:ajaxExceptionHandler onexception="PF('excWid').show();" update="expDialog" type="java.lang.Throwable"/>

        <p:dialog id="expDialog" widgetVar="excWid" header="Ошибка на странице - #{pfExceptionHandler.type}"
                             width="800" height="600" position="center,center" fitViewport="true" modal="true">
        <h:outputText value="Обратитесь в тех. поддержку"/> <br />
        <p:button value="Перезагрузить страницу" style="margin:20px 5px 20px 5px" onclick="document.location.href = document.location.href;"/><br/>
        <h:outputText value="#{pfExceptionHandler.message}"/><br/>
        <h:outputText value="#{pfExceptionHandler.formattedTimestamp}"/><br/>
        <h:outputText value="#{pfExceptionHandler.formattedStackTrace.substring(0,pfExceptionHandler.formattedStackTrace.length()>570?570:pfExceptionHandler.formattedStackTrace.length())}" escape="false"/><br/>
        </p:dialog>
    </ui:insert>
</h:body>

<!--<ui:debug hotkey="x"/>-->
</html>